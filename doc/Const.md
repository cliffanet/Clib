# NAME

Clib::Const - кодключение конфига или констант из внешнего файла

# SYNOPSIS

    # Подключаем файл const.conf, лежащий в корне проекта
    # и описывающий набор констант, которые мы будем использовать:
    
    use Clib::Const;
    
    # Теперь можем использовать любую сонстанту через функцию c():
    
    print c('myname');

# Типовое подключение

Структура файлов:

Для скрипта `script`:

    use Clib::Proc qw|script1 lib|;
    use Clib::Const ':utf8';

Если подключение (самый первый вызов `use Clib::Const`) выполнено из модуля `module.pm`:

    use Clib::Proc qw|lib1 lib|;
    use Clib::Const ':utf8';

# DESCRIPTION

Обычно для настройки проекта используют обычный perl-файл, в котоорм описывают разные переменные,
а потом подключают этот файл директивой: `require "my.conf"`.

Данный модуль позволяет решить следующие проблемы:

- Использовать глобальный конфиг, не зависимо от того, в каком модуле и в каком namespace мы хотим
обратиться к нашим переменным. Например, при использовании в модуле `MyModule` нам не придётся
писать `$::myname` или `$main::myname`. Мы всегда и везде будем использовать конструкцию: `c('myname')`.
- При необходимости всегда можно использовать несколько разных конфиг-файлов с разными namespace.
- Меньше сложностей с обновлением конфига после его изменения в выполняемом приложении.
- Возможно использование локального переопределения некоторых глобальных констант.

# Подключение конфига

Cтандартное подключение модуля:

    use Clib::Const;

Когда эта строчка встречается самый первый раз в выполняемом коде, загружаются конфиг-файлы.
При всех последующих (например, в разных модулях проекта) - только импорт функций для обращения
к загруженному ранее конфига. Это важно понимать для определения места, откуда будет загружен
конфиг файл.

При этом выполнится загрузка следующих файлов относительно корня проекта:

- const.conf
- const/const.conf
- redefine.conf
- const/redefine.conf

Константы, определённые в каждом следующем файле будут переопределять константы, указанные в файлах перед этим.

Опции подключения для определения корня проекта:

- :scriptX - используя модуль [Clib::Proc](https://metacpan.org/pod/Clib%3A%3AProc), ориентируется относительно
местоположения скрипта, из которого выполнено подключение (самый первый вызов `use Clib::Const`).

    Например, такой вариант вызова означает, что корнем проекта будет директория уровнем выше запущенного скрипта:

        use Clib::Const ':script1';

- :libX - аналогично предыдущему варианту, но относительно расположения модуля, из которого 
выполнено подключение (самый первый вызов `use Clib::Const`).
- <путь> - Непосредственно указанный абсолютный путь:

        use Clib::Const '/home/myproject';

    Если путь указан относительным, то требуется предварительное подключение модуля  [Clib::Proc](https://metacpan.org/pod/Clib%3A%3AProc), чтобы определить корень проекта.

Указывать эти опции подключения необязательно, если перед этим был подключен модуль [Clib::Proc](https://metacpan.org/pod/Clib%3A%3AProc) с соответствующими опциями.

# UNICODE

Чтобы строки в конфиг-файле интерпретировались как UTF-8, необходимо указать опцию подключения `:utf8`:

    use Clib::Const ':utf8';

# Формат конфиг-файла

Синтаксис идентичен Perl-коду, который надо включить внутрь круглых скобок, например, для определения массива.

Пример:

    template_module_dir => 'template.mod',
    template_force_rebuild => 1,
    
    db => {
        host        => 'localhost',
        name        => 'switch',
        user        => 'switch',                # Имя пользователя
        password    => 'nnm',                   # Пароль доступа
    },

В самом начале файла можно (но необязательно) указать строчку:

    #!/usr/bin/perl

Это не повлияет на определение переменных, но позволит некоторым текстовым редакторам корректно подсвечивать текст.
